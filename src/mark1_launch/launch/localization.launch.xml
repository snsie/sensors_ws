<launch>
  <arg name="map" default="/mnt/ssd/dev/sensors_ws/src/mark1_launch/maps/my_map.yaml"/>
  <arg name="params_file" default="/mnt/ssd/dev/sensors_ws/src/mark1_launch/config/nav2_params.yaml"/>
  <arg name="use_sim_time" default="false"/>

  <node pkg="nav2_map_server" exec="map_server" name="map_server" output="screen">
    <!-- This is the key line: set the map YAML path -->
    <param name="yaml_filename" value="$(var map)"/>
    <param name="use_sim_time" value="$(var use_sim_time)"/>
    <!-- If you also keep map_server params in your YAML, include them: -->
    <!-- <param from="$(var params_file)"/> -->
  </node>

  <node pkg="nav2_amcl" exec="amcl" name="amcl" output="screen">
    <!-- Pull AMCL block from your nav2_params.yaml -->
    <param from="$(var params_file)"/>
    <param name="use_sim_time" value="$(var use_sim_time)"/>
  </node>

  <node pkg="nav2_lifecycle_manager" exec="lifecycle_manager"
        name="lifecycle_manager_localization" output="screen">
    <!-- Prefer to keep these inside nav2_params.yaml; this is just a safe fallback -->
    <param from="$(var params_file)"/>
    <param name="use_sim_time" value="$(var use_sim_time)"/>
    <!-- Fallbacks if not set in params file -->
    <!-- <param name="autostart" value="true"/> -->
    <!-- <param name="node_names" value="['map_server','amcl']"/> -->
  </node>
</launch>